
```{r}
library(tidyverse)
library(duckdb)
library(gganimate)

con <- dbConnect(duckdb(), 'data/bdb.duckdb')
tbl(con, "tracking_clean")
```

```{r}
source("https://raw.githubusercontent.com/mlfurman3/gg_field/main/gg_field.R")
```

```{r}
d <- tbl(con, "tracking_clean") |>
  filter(gameId == 2022090800, playId == 56) |>
  left_join(tbl(con, "plays")) |>
  collect()

cols_fill <- c("dodgerblue1", "#663300", "firebrick1")
cols_col <- c("#000000", "#663300", "#000000")
size_vals <- c(6, 4, 6)
shape_vals <- c(21, 16, 21)

plot_title <- d$playDescription
nFrames <- max(d$frameId)

anim <- ggplot() +
  gg_field(yardmin = 0, yardmax = 122) +
  theme(
    panel.background = element_rect(
      fill = "forestgreen",
      color = "forestgreen"
    ),
    panel.grid = element_blank()
  ) +
  # setting size and color parameters
  scale_size_manual(values = size_vals, guide = FALSE) +
  scale_shape_manual(values = shape_vals, guide = FALSE) +
  scale_fill_manual(values = cols_fill, guide = FALSE) +
  scale_colour_manual(values = cols_col, guide = FALSE) +
  geom_point(data = d, aes(x, y, shape = team, fill = team, group = nflId, size = team, color = team)) +
  geom_text(
    data = d,
    aes(x = x, y = y, label = jerseyNumber),
    colour = "white",
    vjust = 0.36, size = 3.5
  ) +
  transition_time(frameId) +
  ease_aes("linear") +
  NULL

anim_save(
  "./ExamplePlay.gif",
  animate(anim,
    width = 720, height = 440,
    fps = 10, nframe = nFrames
  )
)

```


```{r}

```
